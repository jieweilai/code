(1) 将原始图像 I_(m×n) 分解为 M×N 个子图像( x方向M个，y方向N个)。如果 M=4，N=4. 则分解结果如下：
 
                  原始图像                             分解为4*4个子图像
(2) 图像经过分解之后得到M×N个子图像，对每个子图像进行如下操作。（假设subimage为任意一个子图像）
① 求出subimage子图像的直方图h(i)，将h(i)中大于阈值T1的部分置为T1,小于阈值T2的部分置为0。即
                           If h(i)>T1
                             h(i)=T1；
                           If h(i)<T2
                           h(i)=0;
     其中 T1=0.8*max⁡(h), T2=0.1*max⁡(h), max(h)为h中的最大值                   
     ② 通过步骤 ① 得到新的直方图newh(i).求出每个灰度i 的概率密度p_i=newh(i)/sum(newh). 然后对p_i进行累加操作，得到原始图像中灰度级 k(k=0,…,N-1)映射后的灰度级T(k)
                        
其中N=256，⌊a⌋ 为a的整数部分。
③ 得到T(k)之后，将原始图像中灰度级为 k(k=0,…,N-1)的像素点替换为新的灰度级T(k)。所有的灰度级替换完毕得到新的增强后子图像。
(3) 插值操作：假设subimage(i,j) 为 x方向第 i(1≤i≤M) 个， y方向第 j(1≤j≤N)个子图像，对非周边子图像 (subimage(i,j)(2≤i≤M-1,2≤j≤N-1))中的每个点进行如下插值操作，消除块效应。

      
假设(x,y)为原始图像中任意一点，其灰度值为 k （增强之前的灰度值）。 ,  是其周围4个子图像的中心点位置（如上图所示）。通过步骤2可以得到该四个子图像的四个灰度映射函数 。
假设 
则(x,y)点处灰度级k在插值后的灰度级变为：
 
其中
 
